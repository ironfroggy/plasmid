<!doctype html>

<textarea id="scratch">
</textarea>

<input type="file" id="file" />

<br />

<img id="image" src="image.jpeg" style="display: none;" />
<canvas id="canvas" width="1024" height="640" >

<script type="text/javascript" src="base64.js"></script>
<script type="text/javascript" src="jsonsca.js"></script>
<script type="text/javascript" src="plasmid.js"></script>
<script type="text/javascript">

    // This is what our customer data looks like.
    const customerData = [
      { ssn: "444-44-4444", name: "Bill", age: 35, email: "bill@company.com" },
      { ssn: "555-55-5555", name: "Donna", age: 32, email: "donna@home.org" }
    ];
    const api = window.location.protocol + '//' + window.location.host + '/v1/';
    const access = "test";
    const secret = "test";

    function log() {
        console.log.apply(console, arguments);
    }

    var database = new plasmid.Database({
        name: 'test',
        api: api,
        schema: {
            version: 2,
            stores: {
                temp: {sync: false },
                shared: {sync: true },
                other: {sync: true },
            },
        },
        access: access,
        secret: secret
    });

    var accesstoken = new plasmid.AccessToken({
        auth: {access: access, secret: secret}
    ,   token: access
    ,   api: api
    });

    var scratch = document.getElementById('scratch');
    scratch.onkeyup = function() {
        database.stores.shared.put('scratch', {contents: this.value})
    }
    database.on('opensuccess', load_and_show);

    function load_and_show() {
        database.sync()
        .then(function(){
            database.stores.shared.get('scratch').then(function(value){
                scratch.value = value.contents;
            });

            database.stores.shared.get('imagedata').then(function(imagedata){
                ctx.putImageData(imagedata, 0, 0);
            });
        });
    };

    var file = document.getElementById('file').files[0];
    var image = document.getElementById('image');
    var canvas = document.getElementById('canvas');
    var ctx = canvas.getContext('2d');

</script>

